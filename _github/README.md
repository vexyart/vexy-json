# GitHub Workflows

This directory contains the planned GitHub Actions workflows for the project. These are templates that should be moved to `.github/` when ready to implement.

## Documentation Workflows

### mkdocs-build.yml
Comprehensive workflow for building MkDocs documentation from `src_docs/` to `docs/`:

**Features:**
- Builds from `src_docs/mkdocs.yml` configuration
- Outputs to `docs/` directory (replaces existing content)
- Validates HTML and checks links
- Auto-commits generated documentation
- Deploys to GitHub Pages
- Comments on PRs with build status

**Triggers:**
- Push to `main` or `develop` branches (when `src_docs/` changes)
- Pull requests (for validation)
- Manual workflow dispatch

### docs-deploy.yml
Simplified deployment workflow that handles both MkDocs and Jekyll:

**Features:**
- Detects which documentation system to use
- Falls back to existing Jekyll build if MkDocs not changed
- Direct deployment to GitHub Pages
- Lighter weight for simple deployments

## Usage

To activate these workflows:

1. **Copy to .github/workflows/:**
   ```bash
   cp _github/workflows/* .github/workflows/
   ```

2. **Update repository settings:**
   - Enable GitHub Pages
   - Set source to "GitHub Actions"
   - Configure branch protection if needed

3. **Install dependencies (optional):**
   ```bash
   echo "mkdocs" >> requirements-docs.txt
   echo "mkdocs-material" >> requirements-docs.txt
   echo "mkdocs-minify-plugin" >> requirements-docs.txt
   ```

4. **Test the workflow:**
   - Make a change to `src_docs/`
   - Push to a feature branch
   - Create a PR to see the build validation

## MkDocs Configuration

The workflows expect:
- **Source:** `src_docs/mkdocs.yml` configuration file
- **Content:** `src_docs/md/` directory with Markdown files
- **Output:** `docs/` directory (auto-generated, don't edit manually)

## Existing Integration

These workflows are designed to work alongside the existing documentation structure:
- `docs-src/` - Existing Jekyll documentation (preserved)
- `docs/` - Will be generated by MkDocs (replaces current content)
- `mkdocs.yml` - Root level config (may conflict, consider moving)

## Migration Strategy

1. **Phase 1:** Add workflows without activation
2. **Phase 2:** Test workflows on feature branches
3. **Phase 3:** Activate workflows for `main` branch
4. **Phase 4:** Remove old documentation build processes
5. **Phase 5:** Archive or remove `docs-src/` if no longer needed

## Workflow Dependencies

**Python packages:**
- `mkdocs` - Core MkDocs functionality
- `mkdocs-material` - Material Design theme
- `mkdocs-minify-plugin` - HTML/CSS/JS minification

**GitHub Actions:**
- `actions/checkout@v4` - Repository checkout
- `actions/setup-python@v4` - Python environment
- `actions/upload-artifact@v3` - Artifact storage
- `peaceiris/actions-gh-pages@v3` - GitHub Pages deployment

## Customization

### Adding Plugins
Edit the workflow to install additional MkDocs plugins:

```yaml
- name: Install dependencies
  run: |
    pip install mkdocs mkdocs-material
    pip install mkdocs-awesome-pages-plugin
    pip install mkdocs-git-revision-date-localized-plugin
```

### Custom Build Steps
Add additional build steps before the MkDocs build:

```yaml
- name: Generate API docs
  run: |
    cargo doc --no-deps
    cp -r target/doc src_docs/api/

- name: Build documentation
  run: |
    cd src_docs
    mkdocs build --clean --strict
```

### Environment Variables
Configure build-time variables:

```yaml
env:
  MKDOCS_VERSION: "latest"
  SITE_URL: "https://vexyart.github.io/vexy-json"
```

## Troubleshooting

### Common Issues

1. **Build failures:**
   - Check `mkdocs.yml` syntax
   - Verify all referenced files exist
   - Check Python package versions

2. **Missing files:**
   - Ensure `src_docs/md/` contains all referenced Markdown files
   - Check navigation configuration in `mkdocs.yml`

3. **Permission errors:**
   - Verify repository has GitHub Pages enabled
   - Check workflow permissions in repository settings

### Debug Steps

1. **Local testing:**
   ```bash
   cd src_docs
   mkdocs serve  # Test locally
   mkdocs build --clean --strict  # Test build
   ```

2. **Workflow debugging:**
   - Enable debug logging in Actions
   - Check artifact uploads
   - Review workflow logs

## Security Considerations

- Workflows run with minimal required permissions
- No secrets required for public repositories
- Artifacts are retained for 30 days only
- All dependencies pinned to specific versions